<!DOCTYPE html>
<html>
    <head>
        <style>
            /* Set the size of the div element that contains the map */
            #map {
                height: 400px; /* The height is 400 pixels */
                width: 50%; /* The width is the width of the web page */
            }
        </style>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>

    <body>
        <h3>Enter searchquery for Restaurant API</h3>
        <input type='text' id='searchQuery'>
        <input type='submit' onclick='data()'>
        <h3>Google Maps API</h3>
        <div>Latitude: <span id="latitude"></span></div>
        <div>Longitude: <span id="longitude"></span></div>
        <div>Nearest MRT Station: <span id="nearestMrtStation"></span></div>

        <!--The div element for the map -->
        <div id="map"></div>

        <script>
            // function data() {
            //     var searchQuery = document.getElementById('searchQuery').value
            //     //console.log(searchQuery);
    
            //     var url = 'https://tih-api.stb.gov.sg/content/v1/food-beverages/search?keyword=' + searchQuery + '&language=en&apikey=e8o8lSAcpTGJx0xnGiUDzfyZ7ksA29F8';
            //     // var url = 'https://tih-api.stb.gov.sg/content/v1/food-beverages/search?keyword=chinese&language=en&apikey=e8o8lSAcpTGJx0xnGiUDzfyZ7ksA29F8'
    
            //     axios.get(url)
            //         .then(response => {
            //             //console.log(response.data);
            //             var dataArr = response.data.data;
            //             // for(var restaurant of dataArr){    // if we wanna do a loop, but for simplicity's sake im just using the first result
            //             // }
            //             var restaurant = dataArr[0]
                        
            //             longitude = restaurant.location.longitude
            //             latitude = restaurant.location.latitude

            //             console.log(longitude)
            //             console.log(latitude)

            //             .catch(error => {
            //                 console.log(error.message)
            //             })
            //         }
            // }

            function data() {
            var searchQuery = document.getElementById('searchQuery').value;
            //console.log(searchQuery);

            var url = 'https://tih-api.stb.gov.sg/content/v1/food-beverages/search?keyword=' + searchQuery + '&language=en&apikey=e8o8lSAcpTGJx0xnGiUDzfyZ7ksA29F8';
            // var url = 'https://tih-api.stb.gov.sg/content/v1/food-beverages/search?keyword=chinese&language=en&apikey=e8o8lSAcpTGJx0xnGiUDzfyZ7ksA29F8'

            axios.get(url)
                .then(response => {
                    //console.log(response.data);
                    var dataArr = response.data.data;
                    var restaurant = dataArr[0]

                    // Location Information
                    longitude = restaurant.location.longitude
                    latitude = restaurant.location.latitude
                    nearestMrtStation = restaurant.nearestMrtStation
                    document.getElementById("longitude").innerText = longitude
                    document.getElementById("latitude").innerText = latitude
                    document.getElementById("nearestMrtStation").innerText = nearestMrtStation

                    console.log("longtitude: ", longitude)
                    console.log("latitude: ", latitude)
                    console.log("nearestMrtStation: ", nearestMrtStation)

                })
                .catch(error => {
                    console.log(error.message)
                })

        }
        </script>

        <!-- <script>

            latitude = parseFloat(document.getElementById("longtitude").innerText).toFixed(6)
            longitude = parseFloat(document.getElementById("latitude").innerText).toFixed(6)
            function initMap() {
                // The location of the restaurant
                // var coordinates = { lat: 1.2892953, lng: 103.8556476}; //this is chinese restaurant location
                // var coordinates = { lat: 1.297538, lng: 103.849558 };

                var coordinates = {lat: latitude, lng: longitude};

                
                // The map, centered at restaurant location
                var map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 26,
                    center: coordinates,
                });
                // The marker, positioned at the restaurant
                var marker = new google.maps.Marker({
                    position: coordinates,
                    map: map,
                });
            }
        </script> -->

        <script 
            defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyChD1BmL1SDUnX5-KmIg5Kr60tLpIBB4q4&callback=initMap"
        ></script> <!-- don't remove this it is the google API link--> <!-- apparently this calls initMap() immediately-->

    </body>
</html>
